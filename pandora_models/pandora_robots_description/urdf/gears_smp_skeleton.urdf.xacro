<?xml version="1.0" ?>

<robot xmlns:xacro="http://ros.org/wiki/xacro">
  
  <xacro:include filename="$(find pandora_robots_description)/urdf/gears_smp_wheel.urdf.xacro" />
  
  <xacro:macro name="skeleton_caster" params="suffix reflect parent *origin">
    <link
      name="${suffix}_skeleton_link">
      <inertial>
        <origin
          xyz="${reflect*0.000321826891202733} ${reflect*0.0306251328024513} -0.0286468811169595"
          rpy="0 0 0" />
        <mass
          value="0.935564689065556" />
        <inertia
          ixx="0.00121424029996205"
          ixy="-3.61897856814031E-05"
          ixz="${reflect*0.000282870223575218}"
          iyy="0.0266729414871034"
          iyz="${reflect*-0.000245282816062407}"
          izz="0.026451061221961" />
      </inertial>
      <visual>
        <origin
          xyz="0 0 0"
          rpy="0 0 ${(1-reflect)*1.57}" />
        <geometry>
          <mesh
            filename="package://pandora_robots_description/meshes/gears_smp/skeleton_link.stl" />
        </geometry>
        <material
          name="">
          <color
            rgba="0.753 0.753 0.753 1" />
        </material>
      </visual>
      <collision>
        <origin
          xyz="0 0 0"
          rpy="0 0 ${(1-reflect)*1.57}" />
        <geometry>
          <mesh
            filename="package://pandora_robots_description/meshes/gears_smp/skeleton_link.stl" />
        </geometry>
      </collision>
    </link>
    
    <joint
      name="${suffix}_skeleton_joint"
      type="revolute">
      <xacro:insert_block name="origin" />
      <parent
        link="${parent}" />
      <child
        link="${suffix}_skeleton_link" />
      <axis
        xyz="0 1 0" />
      <limit
        effort="100" 
        velocity="100"
        lower="-0.785" 
        upper="0.785"/>
    </joint>
    
    <xacro:wheel_caster suffix_a="${suffix}" suffix_b="front" reflect_a="${reflect}" reflect_b="1" />
    
    <xacro:wheel_caster suffix_a="${suffix}" suffix_b="rear" reflect_a="${reflect}" reflect_b="-1" />
    
  </xacro:macro>
</robot>
